/*! iFrame Resizer (iframeSizer.contentWindow.min.js) - v3.1.1 - 2015-09-01
 *  Desc: Include this file in any page being loaded into an iframe
 *        to force the iframe to resize to the content size.
 *  Requires: iframeResizer.min.js on host page.
 *  Copyright: (c) 2015 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 */

!function(a){"use strict";function b(b,c,d){"addEventListener"in a?b.addEventListener(c,d,!1):"attachEvent"in a&&b.attachEvent("on"+c,d)}function c(b,c,d){"removeEventListener"in a?b.removeEventListener(c,d,!1):"detachEvent"in a&&b.detachEvent("on"+c,d)}function d(a){return a.charAt(0).toUpperCase()+a.slice(1)}function e(a){var b,c,d,e=null,f=0,g=function(){f=za(),e=null,d=a.apply(b,c),e||(b=c=null)};return function(){var h=za();f||(f=h);var i=ta-(h-f);return b=this,c=arguments,0>=i||i>ta?(e&&(clearTimeout(e),e=null),f=h,d=a.apply(b,c),e||(b=c=null)):e||(e=setTimeout(g,i)),d}}function f(a){return ja+"["+la+"] "+a}function g(b){ia&&"object"==typeof a.console&&console.log(f(b))}function h(b){"object"==typeof a.console&&console.warn(f(b))}function i(){j(),g("Initialising iFrame ("+location.href+")"),k(),n(),m("background",U),m("padding",Y),z(),s(),t(),o(),B(),u(),ga=A(),L("init","Init message from host page"),ya()}function j(){function a(a){return"true"===a?!0:!1}var b=fa.substr(ka).split(":");la=b[0],V=void 0!==b[1]?Number(b[1]):V,Z=void 0!==b[2]?a(b[2]):Z,ia=void 0!==b[3]?a(b[3]):ia,ha=void 0!==b[4]?Number(b[4]):ha,S=void 0!==b[6]?a(b[6]):S,W=b[7],da=void 0!==b[8]?b[8]:da,U=b[9],Y=b[10],qa=void 0!==b[11]?Number(b[11]):qa,ga.enable=void 0!==b[12]?a(b[12]):!1,na=void 0!==b[13]?b[13]:na,wa=void 0!==b[14]?b[14]:wa}function k(){function b(){var b=a.iFrameResizer;g("Reading data from page: "+JSON.stringify(b)),xa=void 0!==b.messageCallback?b.messageCallback:xa,ya=void 0!==b.readyCallback?b.readyCallback:ya,pa=void 0!==b.targetOrigin?b.targetOrigin:pa,da=void 0!==b.heightCalculationMethod?b.heightCalculationMethod:da,wa=void 0!==b.widthCalculationMethod?b.widthCalculationMethod:wa}"iFrameResizer"in a&&Object===a.iFrameResizer.constructor&&b()}function l(a,b){return-1!==b.indexOf("-")&&(h("Negative CSS value ignored for "+a),b=""),b}function m(a,b){void 0!==b&&""!==b&&"null"!==b&&(document.body.style[a]=b,g("Body "+a+' set to "'+b+'"'))}function n(){void 0===W&&(W=V+"px"),l("margin",W),m("margin",W)}function o(){document.documentElement.style.height="",document.body.style.height="",g('HTML & body height set to "auto"')}function p(e){function f(){L(e.eventName,e.eventType)}var h={add:function(c){b(a,c,f)},remove:function(b){c(a,b,f)}};e.eventNames&&Array.prototype.map?(e.eventName=e.eventNames[0],e.eventNames.map(h[e.method])):h[e.method](e.eventName),g(d(e.method)+" event listener: "+e.eventType)}function q(a){p({method:a,eventType:"Animation Start",eventNames:["animationstart","webkitAnimationStart"]}),p({method:a,eventType:"Animation Iteration",eventNames:["animationiteration","webkitAnimationIteration"]}),p({method:a,eventType:"Animation End",eventNames:["animationend","webkitAnimationEnd"]}),p({method:a,eventType:"Orientation Change",eventName:"orientationchange"}),p({method:a,eventType:"Input",eventName:"input"}),p({method:a,eventType:"Print",eventName:["afterprint","beforeprint"]}),p({method:a,eventType:"Transition End",eventNames:["transitionend","webkitTransitionEnd","MSTransitionEnd","oTransitionEnd","otransitionend"]}),p({method:a,eventType:"Mouse Up",eventName:"mouseup"}),p({method:a,eventType:"Mouse Down",eventName:"mousedown"}),"child"===na&&p({method:a,eventType:"IFrame Resized",eventName:"resize"})}function r(a,b,c,d){b!==a&&(a in c||(h(a+" is not a valid option for "+d+"CalculationMethod."),a=b),g(d+' calculation method set to "'+a+'"'))}function s(){r(da,ca,Aa,"height")}function t(){r(wa,va,Ba,"width")}function u(){!0===S?(q("add"),E()):g("Auto Resize disabled")}function v(){g("Disable outgoing messages"),oa=!1}function w(){g("Remove event listener: Message"),c(a,"message",Q)}function x(){"disconnect"in X&&X.disconnect()}function y(){v(),w(),q("remove"),x()}function z(){var a=document.createElement("div");a.style.clear="both",a.style.display="block",document.body.appendChild(a)}function A(){function c(){return{x:void 0!==a.pageXOffset?a.pageXOffset:document.documentElement.scrollLeft,y:void 0!==a.pageYOffset?a.pageYOffset:document.documentElement.scrollTop}}function d(a){var b=a.getBoundingClientRect(),d=c();return{x:parseInt(b.left,10)+parseInt(d.x,10),y:parseInt(b.top,10)+parseInt(d.y,10)}}function e(a){function b(a){var b=d(a);g("Moving to in page link (#"+c+") at x: "+b.x+" y: "+b.y),P(b.y,b.x,"scrollToOffset")}var c=a.split("#")[1]||a,e=decodeURIComponent(c),f=document.getElementById(e)||document.getElementsByName(e)[0];f?b(f):(g("In page link (#"+c+") not found in iFrame, so sending to parent"),P(0,0,"inPageLink","#"+c))}function f(){""!==location.hash&&"#"!==location.hash&&e(location.href)}function i(){function a(a){function c(a){a.preventDefault(),e(this.getAttribute("href"))}"#"!==a.getAttribute("href")&&b(a,"click",c)}Array.prototype.forEach.call(document.querySelectorAll('a[href^="#"]'),a)}function j(){b(a,"hashchange",f)}function k(){setTimeout(f,_)}function l(){Array.prototype.forEach&&document.querySelectorAll?(g("Setting up location.hash handlers"),i(),j(),k()):h("In page linking not fully supported in this browser! (See README.md for IE8 workaround)")}return ga.enable?l():g("In page linking not enabled"),{findTarget:e}}function B(){g("Enable public methods"),a.parentIFrame={close:function(){P(0,0,"close"),y()},getId:function(){return la},moveToAnchor:function(a){ga.findTarget(a)},reset:function(){O("parentIFrame.reset")},scrollTo:function(a,b){P(b,a,"scrollTo")},scrollToOffset:function(a,b){P(b,a,"scrollToOffset")},sendMessage:function(a,b){P(0,0,"message",JSON.stringify(a),b)},setHeightCalculationMethod:function(a){da=a,s()},setWidthCalculationMethod:function(a){wa=a,t()},setTargetOrigin:function(a){g("Set targetOrigin: "+a),pa=a},size:function(a,b){var c=""+(a?a:"")+(b?","+b:"");M(),L("size","parentIFrame.size("+c+")",a,b)}}}function C(){0!==ha&&(g("setInterval: "+ha+"ms"),setInterval(function(){L("interval","setInterval: "+ha)},Math.abs(ha)))}function D(){function b(a){function b(a){!1===a.complete&&(g("Attach listeners to "+a.src),a.addEventListener("load",f,!1),a.addEventListener("error",h,!1),k.push(a))}"attributes"===a.type&&"src"===a.attributeName?b(a.target):"childList"===a.type&&Array.prototype.forEach.call(a.target.querySelectorAll("img"),b)}function c(a){k.splice(k.indexOf(a),1)}function d(a){g("Remove listeners from "+a.src),a.removeEventListener("load",f,!1),a.removeEventListener("error",h,!1),c(a)}function e(a,b,c){d(a.target),L(b,c+": "+a.target.src,void 0,void 0)}function f(a){e(a,"imageLoad","Image loaded")}function h(a){e(a,"imageLoadFailed","Image load failed")}function i(a){L("mutationObserver","mutationObserver: "+a[0].target+" "+a[0].type),a.forEach(b)}function j(){var a=document.querySelector("body"),b={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0};return m=new l(i),g("Enable MutationObserver"),m.observe(a,b),m}var k=[],l=a.MutationObserver||a.WebKitMutationObserver,m=j();return{disconnect:function(){"disconnect"in m&&(g("Disconnect MutationObserver"),m.disconnect(),k.forEach(d))}}}function E(){var b=0>ha;a.MutationObserver||a.WebKitMutationObserver?b?C():X=D():(h("MutationObserver not supported in this browser!"),C())}function F(a){function b(a){var b=/^\d+(px)?$/i;if(b.test(a))return parseInt(a,T);var d=c.style.left,e=c.runtimeStyle.left;return c.runtimeStyle.left=c.currentStyle.left,c.style.left=a||0,a=c.style.pixelLeft,c.style.left=d,c.runtimeStyle.left=e,a}var c=document.body,d=0;return"defaultView"in document&&"getComputedStyle"in document.defaultView?(d=document.defaultView.getComputedStyle(c,null),d=null!==d?d[a]:0):d=b(c.currentStyle[a]),parseInt(d,T)}function G(a,b){for(var c=b.length,d=0,e=za(),f=0;c>f;f++)b[f].getBoundingClientRect()[a]>d&&(d=b[f].getBoundingClientRect()[a]);return e=za()-e,g("Parsed "+c+" HTML elements"),g("Element position calculated in "+e+"ms"),e>ta/2&&(ta=2*e,g("Event throttle increased to "+ta+"ms")),d}function H(a){return[a.bodyOffset(),a.bodyScroll(),a.documentElementOffset(),a.documentElementScroll()]}function I(a,b){function c(){return h("No tagged elements ("+b+") found on page"),ba}var d=document.querySelectorAll("["+b+"]");return 0===d.length?c():G(a,d)}function J(){return document.querySelectorAll("body *")}function K(a,b,c,d){function e(){ba=l,ua=m,P(ba,ua,a)}function f(){function a(a,b){var c=Math.abs(a-b)<=qa;return!c}return l=void 0!==c?c:Aa[da](),m=void 0!==d?d:Ba[wa](),a(ba,l)||Z&&a(ua,m)}function h(){return!(a in{init:1,interval:1,size:1})}function i(){return da in ma||Z&&wa in ma}function j(){g("No change in size detected")}function k(){h()&&i()?O(b):a in{interval:1}||j()}var l,m;f()||"init"===a?(M(),e()):k()}function L(a,b,c,d){function e(){a in{reset:1,resetPage:1,init:1}||g("Trigger event: "+b)}function f(){return ra&&a in $}f()?g("Trigger event cancelled: "+a):(e(),Ca(a,b,c,d))}function M(){ra||(ra=!0,g("Trigger event lock on")),clearTimeout(sa),sa=setTimeout(function(){ra=!1,g("Trigger event lock off"),g("--")},_)}function N(a){ba=Aa[da](),ua=Ba[wa](),P(ba,ua,a)}function O(a){var b=da;da=ca,g("Reset trigger event: "+a),M(),N("reset"),da=b}function P(b,c,d,e,f){function h(){void 0===f?f=pa:g("Message targetOrigin: "+f)}function i(){var h=b+":"+c,i=la+":"+h+":"+d+(void 0!==e?":"+e:"");g("Sending message to host page ("+i+")"),a.parent.postMessage(ja+i,f)}!0===oa&&(h(),i())}function Q(b){function c(){return ja===(""+b.data).substr(0,ka)}function d(){fa=b.data,i(),aa=!1,setTimeout(function(){ea=!1},_)}function e(){ea?g("Page reset ignored by init"):(g("Page size reset by host page"),N("resetPage"))}function f(){L("resizeParent","Parent window requested size check")}function h(){var a=k();ga.findTarget(a)}function j(){return b.data.split("]")[1].split(":")[0]}function k(){return b.data.substr(b.data.indexOf(":")+1)}function l(){return"iFrameResize"in a}function m(){var a=k();g("MessageCallback called from parent: "+a),xa(JSON.parse(a)),g(" --")}function n(){return b.data.split(":")[2]in{"true":1,"false":1}}function o(){switch(j()){case"reset":e();break;case"resize":f();break;case"moveToAnchor":h();break;case"message":m();break;default:!l()&&!n()}}function p(){!1===aa?o():n()?d():g('Ignored message of type "'+j()+'". Received before initialization.')}c()&&p()}function R(){"loading"!==document.readyState&&a.parent.postMessage("[iFrameResizerChild]Ready","*")}var S=!0,T=10,U="",V=0,W="",X=null,Y="",Z=!1,$={resize:1,click:1},_=128,aa=!0,ba=1,ca="bodyOffset",da=ca,ea=!0,fa="",ga={},ha=32,ia=!1,ja="[iFrameSizer]",ka=ja.length,la="",ma={max:1,min:1,bodyScroll:1,documentElementScroll:1},na="child",oa=!0,pa="*",qa=0,ra=!1,sa=null,ta=0,ua=1,va="scroll",wa=va,xa=function(){h("MessageCallback function not defined")},ya=function(){},za=Date.now||function(){return(new Date).getTime()},Aa={bodyOffset:function(){return document.body.offsetHeight+F("marginTop")+F("marginBottom")},offset:function(){return Aa.bodyOffset()},bodyScroll:function(){return document.body.scrollHeight},documentElementOffset:function(){return document.documentElement.offsetHeight},documentElementScroll:function(){return document.documentElement.scrollHeight},max:function(){return Math.max.apply(null,H(Aa))},min:function(){return Math.min.apply(null,H(Aa))},grow:function(){return Aa.max()},lowestElement:function(){return Math.max(Aa.bodyOffset(),G("bottom",J()))},taggedElement:function(){return I("bottom","data-iframe-height")}},Ba={bodyScroll:function(){return document.body.scrollWidth},bodyOffset:function(){return document.body.offsetWidth},documentElementScroll:function(){return document.documentElement.scrollWidth},documentElementOffset:function(){return document.documentElement.offsetWidth},scroll:function(){return Math.max(Ba.bodyScroll(),Ba.documentElementScroll())},max:function(){return Math.max.apply(null,H(Ba))},min:function(){return Math.min.apply(null,H(Ba))},leftMostElement:function(){return G("left",J())},taggedElement:function(){return I("left","data-iframe-width")}},Ca=e(K);b(a,"message",Q),R()}(window||{});
//# sourceMappingURL=iframeResizer.contentWindow.map