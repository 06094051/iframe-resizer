/*! iFrame Resizer (iframeSizer.contentWindow.min.js) - v3.0.0 - 2015-08-26
 *  Desc: Include this file in any page being loaded into an iframe
 *        to force the iframe to resize to the content size.
 *  Requires: iframeResizer.min.js on host page.
 *  Copyright: (c) 2015 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 */

!function(a){"use strict";function b(b,c,d){"addEventListener"in a?b.addEventListener(c,d,!1):"attachEvent"in a&&b.attachEvent("on"+c,d)}function c(a){var b,c,d,e=null,f=0,g=function(){f=ra(),e=null,d=a.apply(b,c),e||(b=c=null)};return function(){var h=ra();f||(f=h);var i=la-(h-f);return b=this,c=arguments,0>=i||i>la?(e&&(clearTimeout(e),e=null),f=h,d=a.apply(b,c),e||(b=c=null)):e||(e=setTimeout(g,i)),d}}function d(a){return ca+"["+ea+"] "+a}function e(b){ba&&"object"==typeof a.console&&console.log(d(b))}function f(b){"object"==typeof a.console&&console.warn(d(b))}function g(){h(),e("Initialising iFrame ("+location.href+")"),i(),l(),k("background",O),k("padding",R),t(),q(),r(),m(),v(),s(),_=u(),F("init","Init message from host page"),qa()}function h(){function a(a){return"true"===a?!0:!1}var b=$.substr(da).split(":");ea=b[0],P=void 0!==b[1]?Number(b[1]):P,S=void 0!==b[2]?a(b[2]):S,ba=void 0!==b[3]?a(b[3]):ba,aa=void 0!==b[4]?Number(b[4]):aa,M=void 0!==b[6]?a(b[6]):M,Q=b[7],Y=void 0!==b[8]?b[8]:Y,O=b[9],R=b[10],ia=void 0!==b[11]?Number(b[11]):ia,_.enable=void 0!==b[12]?a(b[12]):!1,ga=void 0!==b[13]?b[13]:ga,oa=void 0!==b[14]?b[14]:oa}function i(){function b(){var b=a.iFrameResizer;e("Reading data from page: "+JSON.stringify(b)),pa=void 0!==b.messageCallback?b.messageCallback:pa,qa=void 0!==b.readyCallback?b.readyCallback:qa,ha=void 0!==b.targetOrigin?b.targetOrigin:ha,Y=void 0!==b.heightCalculationMethod?b.heightCalculationMethod:Y,oa=void 0!==b.widthCalculationMethod?b.widthCalculationMethod:oa}"iFrameResizer"in a&&Object===a.iFrameResizer.constructor&&b()}function j(a,b){return-1!==b.indexOf("-")&&(f("Negative CSS value ignored for "+a),b=""),b}function k(a,b){void 0!==b&&""!==b&&"null"!==b&&(document.body.style[a]=b,e("Body "+a+' set to "'+b+'"'))}function l(){void 0===Q&&(Q=P+"px"),j("margin",Q),k("margin",Q)}function m(){document.documentElement.style.height="",document.body.style.height="",e('HTML & body height set to "auto"')}function n(c){function d(d){function e(){F(c.eventName,c.eventType)}b(a,d,e)}c.eventNames&&Array.prototype.map?(c.eventName=c.eventNames[0],c.eventNames.map(d)):d(c.eventName),e("Added event listener: "+c.eventType)}function o(){n({eventType:"Animation Start",eventNames:["animationstart","webkitAnimationStart"]}),n({eventType:"Animation Iteration",eventNames:["animationiteration","webkitAnimationIteration"]}),n({eventType:"Animation End",eventNames:["animationend","webkitAnimationEnd"]}),n({eventType:"Orientation Change",eventName:"orientationchange"}),n({eventType:"Input",eventName:"input"}),n({eventType:"Print",eventName:["afterprint","beforeprint"]}),n({eventType:"Transition End",eventNames:["transitionend","webkitTransitionEnd","MSTransitionEnd","oTransitionEnd","otransitionend"]}),n({eventType:"Mouse Up",eventName:"mouseup"}),n({eventType:"Mouse Down",eventName:"mousedown"}),"child"===ga&&n({eventType:"IFrame Resized",eventName:"resize"})}function p(a,b,c,d){b!==a&&(a in c||(f(a+" is not a valid option for "+d+"CalculationMethod."),a=b),e(d+' calculation method set to "'+a+'"'))}function q(){p(Y,X,sa,"height")}function r(){p(oa,na,ta,"width")}function s(){!0===M?(o(),y()):e("Auto Resize disabled")}function t(){var a=document.createElement("div");a.style.clear="both",a.style.display="block",document.body.appendChild(a)}function u(){function c(){return{x:void 0!==a.pageXOffset?a.pageXOffset:document.documentElement.scrollLeft,y:void 0!==a.pageYOffset?a.pageYOffset:document.documentElement.scrollTop}}function d(a){var b=a.getBoundingClientRect(),d=c();return{x:parseInt(b.left,10)+parseInt(d.x,10),y:parseInt(b.top,10)+parseInt(d.y,10)}}function g(a){function b(a){var b=d(a);e("Moving to in page link (#"+c+") at x: "+b.x+" y: "+b.y),J(b.y,b.x,"scrollToOffset")}var c=a.split("#")[1]||a,f=decodeURIComponent(c),g=document.getElementById(f)||document.getElementsByName(f)[0];g?b(g):(e("In page link (#"+c+") not found in iFrame, so sending to parent"),J(0,0,"inPageLink","#"+c))}function h(){""!==location.hash&&"#"!==location.hash&&g(location.href)}function i(){function a(a){function c(a){a.preventDefault(),g(this.getAttribute("href"))}"#"!==a.getAttribute("href")&&b(a,"click",c)}Array.prototype.forEach.call(document.querySelectorAll('a[href^="#"]'),a)}function j(){b(a,"hashchange",h)}function k(){setTimeout(h,U)}function l(){Array.prototype.forEach&&document.querySelectorAll?(e("Setting up location.hash handlers"),i(),j(),k()):f("In page linking not fully supported in this browser! (See README.md for IE8 workaround)")}return _.enable?l():e("In page linking not enabled"),{findTarget:g}}function v(){e("Enable public methods"),a.parentIFrame={close:function(){J(0,0,"close")},getId:function(){return ea},moveToAnchor:function(a){_.findTarget(a)},reset:function(){I("parentIFrame.reset")},scrollTo:function(a,b){J(b,a,"scrollTo")},scrollToOffset:function(a,b){J(b,a,"scrollToOffset")},sendMessage:function(a,b){J(0,0,"message",JSON.stringify(a),b)},setHeightCalculationMethod:function(a){Y=a,q()},setWidthCalculationMethod:function(a){oa=a,r()},setTargetOrigin:function(a){e("Set targetOrigin: "+a),ha=a},size:function(a,b){var c=""+(a?a:"")+(b?","+b:"");G(),F("size","parentIFrame.size("+c+")",a,b)}}}function w(){0!==aa&&(e("setInterval: "+aa+"ms"),setInterval(function(){F("interval","setInterval: "+aa)},Math.abs(aa)))}function x(a){return void 0===a||0===a}function y(){function b(a){function b(a){var b=F.bind(null,"imageLoad","Image loaded",void 0,void 0);(x(a.height)||x(a.width))&&(e("Attach listerner to "+a.src),a.addEventListener("load",b,!1))}"attributes"===a.type&&"src"===a.attributeName?b(a.target):"childList"===a.type&&Array.prototype.forEach.call(a.target.querySelectorAll("img"),b)}function c(a){F("mutationObserver","mutationObserver: "+a[0].target+" "+a[0].type),b(a[0])}function d(){var a=document.querySelector("body"),b={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0},d=new h(c);e("Enable MutationObserver"),d.observe(a,b)}var g=0>aa,h=a.MutationObserver||a.WebKitMutationObserver;h?g?w():d():(f("MutationObserver not supported in this browser!"),w())}function z(a){function b(a){var b=/^\d+(px)?$/i;if(b.test(a))return parseInt(a,N);var d=c.style.left,e=c.runtimeStyle.left;return c.runtimeStyle.left=c.currentStyle.left,c.style.left=a||0,a=c.style.pixelLeft,c.style.left=d,c.runtimeStyle.left=e,a}var c=document.body,d=0;return"defaultView"in document&&"getComputedStyle"in document.defaultView?(d=document.defaultView.getComputedStyle(c,null),d=null!==d?d[a]:0):d=b(c.currentStyle[a]),parseInt(d,N)}function A(a,b){for(var c=b.length,d=0,f=ra(),g=0;c>g;g++)b[g].getBoundingClientRect()[a]>d&&(d=b[g].getBoundingClientRect()[a]);return f=ra()-f,e("Parsed "+c+" HTML elements"),e("Element position calculated in "+f+"ms"),f>la/2&&(la=2*f,e("Event throttle increased to "+la+"ms")),d}function B(a){return[a.bodyOffset(),a.bodyScroll(),a.documentElementOffset(),a.documentElementScroll()]}function C(a,b){function c(){return f("No tagged elements ("+b+") found on page"),W}var d=document.querySelectorAll("["+b+"]");return 0===d.length?c():A(a,d)}function D(){return document.querySelectorAll("body *")}function E(a,b,c,d){function f(){W=l,ma=m,J(W,ma,a)}function g(){function a(a,b){var c=Math.abs(a-b)<=ia;return!c}return l=void 0!==c?c:sa[Y](),m=void 0!==d?d:ta[oa](),a(W,l)||S&&a(ma,m)}function h(){return!(a in{init:1,interval:1,size:1})}function i(){return Y in fa||S&&oa in fa}function j(){e("No change in size detected")}function k(){h()&&i()?I(b):a in{interval:1}||j()}var l,m;g()||"init"===a?(G(),f()):k()}function F(a,b,c,d){function f(){a in{reset:1,resetPage:1,init:1}||e("Trigger event: "+b)}function g(){return ja&&a in T}g()?e("Trigger event cancelled: "+a):(f(),ua(a,b,c,d))}function G(){ja||(ja=!0,e("Trigger event lock on")),clearTimeout(ka),ka=setTimeout(function(){ja=!1,e("Trigger event lock off"),e("--")},U)}function H(a){W=sa[Y](),ma=ta[oa](),J(W,ma,a)}function I(a){var b=Y;Y=X,e("Reset trigger event: "+a),G(),H("reset"),Y=b}function J(b,c,d,f,g){function h(){void 0===g?g=ha:e("Message targetOrigin: "+g)}function i(){var h=b+":"+c,i=ea+":"+h+":"+d+(void 0!==f?":"+f:"");e("Sending message to host page ("+i+")"),a.parent.postMessage(ca+i,g)}h(),i()}function K(b){function c(){return ca===(""+b.data).substr(0,da)}function d(){$=b.data,g(),V=!1,setTimeout(function(){Z=!1},U)}function h(){Z?e("Page reset ignored by init"):(e("Page size reset by host page"),H("resetPage"))}function i(){F("resizeParent","Parent window requested size check")}function j(){var a=l();_.findTarget(a)}function k(){return b.data.split("]")[1].split(":")[0]}function l(){return b.data.split(":")[1]}function m(){return"iFrameResize"in a}function n(){var a=l();e("MessageCallback called from parent: "+a),pa(JSON.parse(a)),e(" --")}function o(){return b.data.split(":")[2]in{"true":1,"false":1}}function p(){switch(k()){case"reset":h();break;case"resize":i();break;case"moveToAnchor":j();break;case"message":n();break;default:m()||o()||f("Unexpected message ("+b.data+")")}}function q(){!1===V?p():o()?d():e('Ignored message of type "'+k()+'". Received before initialization.')}c()&&q()}function L(){"loading"!==document.readyState&&a.parent.postMessage("[iFrameResizerChild]Ready","*")}var M=!0,N=10,O="",P=0,Q="",R="",S=!1,T={resize:1,click:1},U=128,V=!0,W=1,X="bodyOffset",Y=X,Z=!0,$="",_={},aa=32,ba=!1,ca="[iFrameSizer]",da=ca.length,ea="",fa={max:1,min:1,bodyScroll:1,documentElementScroll:1},ga="child",ha="*",ia=0,ja=!1,ka=null,la=0,ma=1,na="scroll",oa=na,pa=function(){f("MessageCallback function not defined")},qa=function(){},ra=Date.now||function(){return(new Date).getTime()},sa={bodyOffset:function(){return document.body.offsetHeight+z("marginTop")+z("marginBottom")},offset:function(){return sa.bodyOffset()},bodyScroll:function(){return document.body.scrollHeight},documentElementOffset:function(){return document.documentElement.offsetHeight},documentElementScroll:function(){return document.documentElement.scrollHeight},max:function(){return Math.max.apply(null,B(sa))},min:function(){return Math.min.apply(null,B(sa))},grow:function(){return sa.max()},lowestElement:function(){return Math.max(sa.bodyOffset(),A("bottom",D()))},taggedElement:function(){return C("bottom","data-iframe-height")}},ta={bodyScroll:function(){return document.body.scrollWidth},bodyOffset:function(){return document.body.offsetWidth},documentElementScroll:function(){return document.documentElement.scrollWidth},documentElementOffset:function(){return document.documentElement.offsetWidth},scroll:function(){return Math.max(ta.bodyScroll(),ta.documentElementScroll())},max:function(){return Math.max.apply(null,B(ta))},min:function(){return Math.min.apply(null,B(ta))},leftMostElement:function(){return A("left",D())},taggedElement:function(){return C("left","data-iframe-width")}},ua=c(E);b(a,"message",K),L()}(window||{});
//# sourceMappingURL=iframeResizer.contentWindow.map