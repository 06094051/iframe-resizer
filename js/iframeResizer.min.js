/*! iFrame Resizer (iframeSizer.min.js ) - v3.1.1 - 2015-09-01
 *  Desc: Force cross domain iframes to size to content.
 *  Requires: iframeResizer.contentWindow.min.js to be loaded into the target frame.
 *  Copyright: (c) 2015 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 */

window.__testHooks__=window.__testHooks__||{},window.__testHooks__.parent={},function(a){"use strict";function b(b,c,d){"addEventListener"in a?b.addEventListener(c,d,!1):"attachEvent"in a&&b.attachEvent("on"+c,d)}function c(){var b,c=["moz","webkit","o","ms"];for(b=0;b<c.length&&!H;b+=1)H=a[c[b]+"RequestAnimationFrame"];H||f("setup","RequestAnimationFrame not supported")}function d(b){var c="Host page: "+b;return a.top!==a.self&&(c=a.parentIFrame?a.parentIFrame.getId()+": "+b:"Nested host page: "+b),c}function e(a){return E+"["+d(a)+"]"}function f(b,c){(J[b]?J[b].log:A)&&"object"==typeof a.console&&console.log(e(b),c)}function g(b,c){"object"==typeof a.console&&console.warn(e(b),c)}function h(b){function c(){function a(){o(N),l(O)}e("Height"),e("Width"),p(a,N,"resetPage")}function d(){var a=M.substr(F).split(":");return{iframe:J[a[0]].iframe,id:a[0],height:a[1],width:a[2],type:a[3]}}function e(a){var b=Number(J[O]["max"+a]),c=Number(J[O]["min"+a]),d=a.toLowerCase(),e=Number(N[d]);if(c>b)throw new Error("Value for min"+a+" can not be greater than max"+a);f(O,"Checking "+d+" is in range "+c+"-"+b),c>e&&(e=c,f(O,"Set "+d+" to min value")),e>b&&(e=b,f(O,"Set "+d+" to max value")),N[d]=""+e}function h(){function a(){function a(){f(O,"Checking connection is from allowed list of origins: "+d);var a;for(a=0;a<d.length;a++)if(d[a]===c)return!0;return!1}function b(){var a=J[O].remoteHost;return f(O,"Checking connection is from: "+a),c===a}return d.constructor===Array?a():b()}var c=b.origin,d=J[O].checkOrigin;if(d&&""+c!="null"&&!a())throw new Error("Unexpected message received from: "+c+" for "+N.iframe.id+". Message was: "+b.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}function s(){return E===(""+M).substr(0,F)&&M.substr(F).split(":")[0]in J}function t(){var a=N.type in{"true":1,"false":1,undefined:1};return a&&f(O,"Ignoring init message from meta parent page"),a}function u(a){return M.substr(M.indexOf(":")+D+a)}function v(a){f(O,"MessageCallback passed: {iframe: "+N.iframe.id+", message: "+a+"}"),B("messageCallback",{iframe:N.iframe,message:JSON.parse(a)}),f(O,"--")}function w(){return null===N.iframe?(g(O,"IFrame ("+N.id+") not found"),!1):!0}function x(a){var b=a.getBoundingClientRect();return k(O),{x:parseInt(b.left,10)+parseInt(G.x,10),y:parseInt(b.top,10)+parseInt(G.y,10)}}function y(b){function c(){G=h,z(),f(O,"--")}function d(){return{x:Number(N.width)+e.x,y:Number(N.height)+e.y}}var e=b?x(N.iframe):{x:0,y:0},h=d();f(O,"Reposition requested from iFrame (offset x:"+e.x+" y:"+e.y+")"),a.top!==a.self?a.parentIFrame?a.parentIFrame["scrollTo"+(b?"Offset":"")](h.x,h.y):g(O,"Unable to scroll to requested position, window.parentIFrame not found"):c()}function z(){!1!==B("scrollCallback",G)?l(O):m()}function A(b){function c(a){var b=x(a);f(O,"Moving to in page link (#"+d+") at x: "+b.x+" y: "+b.y),G={x:b.x,y:b.y},z(),f(O,"--")}var d=b.split("#")[1]||"",e=decodeURIComponent(d),g=document.getElementById(e)||document.getElementsByName(e)[0];a.top!==a.self?a.parentIFrame?a.parentIFrame.moveToAnchor(d):f(O,"In page link #"+d+" not found and window.parentIFrame not found"):g?c(g):f(O,"In page link #"+d+" not found")}function B(a,b){i(O,a,b)}function C(){switch(J[O].firstRun&&K(),N.type){case"close":j(N.iframe);break;case"message":v(u(6));break;case"scrollTo":y(!1);break;case"scrollToOffset":y(!0);break;case"inPageLink":A(u(9));break;case"reset":n(N);break;case"init":c(),B("initCallback",N.iframe),B("resizedCallback",N);break;default:c(),B("resizedCallback",N)}}function H(a){var b=!0;return J[a]||(b=!1,g(N.type+" No settings for "+a+". Message was: "+M)),b}function I(){for(var a in J)q("iFrame requested init",r(a),document.getElementById(a),a)}function K(){J[O].firstRun=!1}var M=b.data,N={},O=null;"[iFrameResizerChild]Ready"===M?I():s()&&(N=d(),O=L=N.id,!t()&&H(O)&&(f(O,"Received: "+M),w()&&h()&&C()))}function i(a,b,c){var d=null,e=null;return J[a]&&(d=J[a][b],"function"==typeof d?e=d(c):g(b+" not a function")),e}function j(a){var b=a.id;f(b,"Removing iFrame: "+b),a.parentNode.removeChild(a),i(b,"closedCallback",b),f(b,"--"),delete J[b]}function k(b){null===G&&(G={x:void 0!==a.pageXOffset?a.pageXOffset:document.documentElement.scrollLeft,y:void 0!==a.pageYOffset?a.pageYOffset:document.documentElement.scrollTop},f(b,"Get page position: "+G.x+","+G.y))}function l(b){null!==G&&(a.scrollTo(G.x,G.y),f(b,"Set page position: "+G.x+","+G.y),m())}function m(){G=null}function n(a){function b(){o(a),q("reset","reset",a.iframe,a.id)}f(a.id,"Size reset requested by "+("init"===a.type?"host page":"iFrame")),k(a.id),p(b,a,"reset")}function o(a){function b(b){a.iframe.style[b]=a[b]+"px",f(a.id,"IFrame ("+e+") "+b+" set to "+a[b]+"px")}function c(b){B||"0"!==a[b]||(B=!0,f(e,"Hidden iFrame detected, creating visibility listener"),v())}function d(a){b(a),c(a)}var e=a.iframe.id;J[e]&&(J[e].sizeHeight&&d("height"),J[e].sizeWidth&&d("width"))}function p(a,b,c){c!==b.type&&H?(f(b.id,"Requesting animation frame"),H(a)):a()}function q(a,b,c,d){function e(){f(d,"["+a+"] Sending msg to iframe["+d+"] ("+b+")"),c.contentWindow.postMessage(E+b,i)}function h(){g(d,"["+a+"] IFrame("+d+") not found"),J[d]&&delete J[d]}d=d||c.id;var i=J[d].targetOrigin;c&&"contentWindow"in c?e():h()}function r(a){return a+":"+J[a].bodyMarginV1+":"+J[a].sizeWidth+":"+J[a].log+":"+J[a].interval+":"+J[a].enablePublicMethods+":"+J[a].autoResize+":"+J[a].bodyMargin+":"+J[a].heightCalculationMethod+":"+J[a].bodyBackground+":"+J[a].bodyPadding+":"+J[a].tolerance+":"+J[a].inPageLinks+":"+J[a].resizeFrom+":"+J[a].widthCalculationMethod}function s(a,c){function d(){function b(b){1/0!==J[v][b]&&0!==J[v][b]&&(a.style[b]=J[v][b]+"px",f(v,"Set "+b+" = "+J[v][b]+"px"))}b("maxHeight"),b("minHeight"),b("maxWidth"),b("minWidth")}function e(b){return L=b,""===b&&(a.id=b=(c.id||M.id)+z++,A=(c||{}).log,L=b,f(b,"Added missing iframe ID: "+b+" ("+a.src+")")),b}function h(){f(v,"IFrame scrolling "+(J[v].scrolling?"enabled":"disabled")+" for "+v),a.style.overflow=!1===J[v].scrolling?"hidden":"auto",a.scrolling=!1===J[v].scrolling?"no":"yes"}function i(){("number"==typeof J[v].bodyMargin||"0"===J[v].bodyMargin)&&(J[v].bodyMarginV1=J[v].bodyMargin,J[v].bodyMargin=""+J[v].bodyMargin+"px")}function k(){var b=J[v].firstRun,c=J[v].heightCalculationMethod in I;!b&&c&&n({iframe:a,height:0,width:0,type:"init"})}function l(){Function.prototype.bind&&(J[v].iframe.iFrameResizer={close:j.bind(null,J[v].iframe),resize:q.bind(null,"Window resize","resize",J[v].iframe),moveToAnchor:function(a){q("Move to anchor","inPageLink:"+a,J[v].iframe,v)},sendMessage:function(a){a=JSON.stringify(a),q("Send Message","message:"+a,J[v].iframe,v)}})}function m(c){function d(){q("iFrame.onload",c,a),k()}b(a,"load",d),q("init",c,a)}function o(a){if("object"!=typeof a)throw new TypeError("Options is not an object.")}function p(a){for(var b in M)M.hasOwnProperty(b)&&(J[v][b]=a.hasOwnProperty(b)?a[b]:M[b])}function s(a){return""===a||"file://"===a?"*":a}function t(b){b=b||{},J[v]={firstRun:!0,iframe:a,remoteHost:a.src.split("/").slice(0,3).join("/")},o(b),p(b),J[v].targetOrigin=!0===J[v].checkOrigin?s(J[v].remoteHost):"*"}function u(){return v in J&&"iFrameResizer"in a}var v=e(a.id);u()?g(v,"Ignored iFrame, already setup."):(t(c),h(),d(),i(),m(r(v)),l())}function t(a,b){null===K&&(K=setTimeout(function(){K=null,a()},b))}function u(a){return null!==a.offsetParent}function v(){function b(){function a(a){function b(b){return"0px"===J[a].iframe.style[b]}u(J[a].iframe)&&(b("height")||b("width"))&&q("Visibility change","resize",J[a].iframe,a)}for(var b in J)a(b)}function c(a){f("window","Mutation observed: "+a[0].target+" "+a[0].type),t(b,16)}function d(){var a=document.querySelector("body"),b={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0},d=new e(c);d.observe(a,b)}var e=a.MutationObserver||a.WebKitMutationObserver;e&&d()}function w(){function c(a){function b(){e("Window "+a,"resize")}f("window","Trigger event: "+a),t(b,16)}function d(){function a(){e("Tab Visable","resize")}"hidden"!==document.visibilityState&&(f("document","Trigger event: Visiblity change"),t(a,16))}function e(a,b){function c(a){return"parent"===J[a].resizeFrom&&J[a].autoResize&&!J[a].firstRun}for(var d in J)c(d)&&q(a,b,document.getElementById(d),d)}b(a,"message",h),b(a,"resize",function(){c("resize")}),b(document,"visibilitychange",d),b(document,"-webkit-visibilitychange",d),b(a,"focusin",function(){c("focus")}),b(a,"focus",function(){c("focus")})}function x(){function a(a,c){if(!c.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==c.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+c.tagName+">.");s(c,a),b.push(c)}var b;return c(),w(),function(c,d){switch(b=[],typeof d){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(d||"iframe"),a.bind(void 0,c));break;case"object":a(c,d);break;default:throw new TypeError("Unexpected data type ("+typeof d+").")}return b}}function y(a){a.fn.iFrameResize=function(a){return this.filter("iframe").each(function(b,c){s(c,a)}).end()}}var z=0,A=!1,B=!1,C="message",D=C.length,E="[iFrameSizer]",F=E.length,G=null,H=a.requestAnimationFrame,I={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},J={},K=null,L="Host Page",M={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,tolerance:0,widthCalculationMethod:"scroll",closedCallback:function(){},initCallback:function(){},messageCallback:function(){g("MessageCallback function not defined")},resizedCallback:function(){},scrollCallback:function(){return!0}};a.jQuery&&y(jQuery),"function"==typeof define&&define.amd?define([],x):"object"==typeof module&&"object"==typeof module.exports?module.exports=x():a.iFrameResize=a.iFrameResize||x()}(window||{});
//# sourceMappingURL=iframeResizer.map